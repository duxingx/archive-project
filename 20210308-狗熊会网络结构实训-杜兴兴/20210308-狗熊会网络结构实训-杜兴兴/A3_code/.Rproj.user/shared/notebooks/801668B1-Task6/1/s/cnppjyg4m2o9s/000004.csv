"0","tmp_data2 = merge(data, tmp_data[, c('id', 'comm_sum_time')]) # 默认按照共同变量(id)进行全连接"
"0",""
"0","tmp_data2$p = tmp_data2$comm_time / tmp_data2$comm_sum_time  # i与j的童话时长所占比例"
"0",""
"0","E = ddply(tmp_data2, .(id), function(x){                     # 按照id变量分组统计信息熵"
"0","    # 计算信息熵的公式"
"0","  -sum(x$p * log(x$p))"
"0","})"
"0",""
"0","colnames(E) = c('id', 'entropy')                             # 对变量重命名"
"0",""
"0","E = E[order(E$entropy, decreasing = T), ]                    # 按照信息熵倒序排列 "
"0",""
"0","head(E)                                                      # 查看前6行"
